name: 🔍 CoCoT GPT-4o Auditor (sem artefato)

on:
  workflow_dispatch:
  push:
    branches: [main]

env:
  PYTHON_VERSION: '3.10'
  OPENAI_MODEL: 'gpt-4o'

jobs:
  audit:
    name: 🔍 Auditoria Completa
    runs-on: ubuntu-latest

    steps:
    - name: 📂 Checkout do Código
      uses: actions/checkout@v4

    - name: 🌐 Setup do Python
      uses: actions/setup-python@v4
      with:
        python-version: ${{ env.PYTHON_VERSION }}

    - name: ⚙️ Instalar dependências
      run: |
        python -m venv venv
        source venv/bin/activate
        pip install -r requirements.txt
        pip install openai

    - name: 🧠 Rodar Auditor GPT-4o
      run: |
        python audit_runner.py \
          --model $OPENAI_MODEL \
          --prompt_file prompts/Super_Prompt_Auditor.txt \
          --output_format markdown
      env:
        OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
        OPENAI_MODEL: ${{ env.OPENAI_MODEL }}
